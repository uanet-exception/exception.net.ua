---
author: "ZEN"
title: "GRUB2: –ü–µ—Ä–µ–∑–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ —Å–∏—Å—Ç–µ–º—É —É —ñ–Ω—à—É –û–° –∑ –º–µ–Ω—é –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è"
# description: ""
date: 2021-05-05T00:37:00+03:00
# lastmod: 2021-05-05T00:37:00+03:00
tags:
  - "awk"
  - "bash"
  - "dialog"
  - "sudo"
  - "grub"
  - "grub-reboot"
  - "linux"
categories:
- "Desktop"
- "Administration"
draft: false
type: "post"
archives: "2021"
---
–£—è–≤—ñ—Ç—å, —â–æ –≤–∏ –≤—Å—Ç–∞–Ω–æ–≤–∏–ª–∏ Linux –Ω–∞ –∫–æ–º–ø'—é—Ç–µ—Ä—ñ –ø–æ—Ä—è–¥ –∑ —ñ–Ω—à–æ—é –æ–ø–µ—Ä–∞—Ü—ñ–π–Ω–æ—é —Å–∏—Å—Ç–µ–º–æ—é. –û—Å—å –≤–∞—Å –≤—ñ—Ç–∞—î –ø—ñ—Å–ª—è –ø–µ—Ä–µ–∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è GRUB2 —Ç–∞ –ø—Ä–æ–ø–æ–Ω—É—î –æ–±—Ä–∞—Ç–∏ –≤ —è–∫—É —Å–∏—Å—Ç–µ–º—É –≤–∏ –±–∞–∂–∞—î—Ç–µ –∑–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏—Å—å —ñ... —Ç—É—Ç –Ω–∞ –≤–∞—Å —á–µ–∫–∞—î –Ω–µ–ø—Ä–∏—î–º–Ω–∏–π –º–æ–º–µ–Ω—Ç - –≤ –∑–∞–ª–µ–∂–Ω–æ—Å—Ç—ñ –≤—ñ–¥ –ø–æ–ª–æ–∂–µ–Ω–Ω—è –ú—ñ—Å—è—Ü—è –Ω–∞ –æ—Ä–±—ñ—Ç—ñ –∫–ª–∞–≤—ñ–∞—Ç—É—Ä–∞ –º–æ–∂–µ –ø—Ä–∞—Ü—é–≤–∞—Ç–∏, –∞ –º–æ–∂–µ —ñ –Ω–µ –ø—Ä–∞—Ü—é–≤–∞—Ç–∏. –ö–ª–∞–≤—ñ–∞—Ç—É—Ä–∞ –ø—ñ–¥'—î–¥–Ω–∞–Ω–∞ —á–µ—Ä–µ–∑ PS/2 –ø–æ—Ä—Ç —ñ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è —É BIOS –Ω–µ –¥–æ–ø–æ–º–∞–≥–∞—é—Ç—å —Ä–æ–∑–≤'—è–∑–∞—Ç–∏ —Ü—é –ø—Ä–æ–±–ª–µ–º—É.

<!--more-->

–°–∞–º–µ —Ç–∞–∫–∞ –ø—Ä–∏–∫—Ä–∞ —Å–∏—Ç—É–∞—Ü—ñ—è —Å—Ç–∞–ª–∞—Å—è –∑ –º–æ—ó–º –∑–Ω–∞–π–æ–º–∏–º. –ó–≤—ñ—Å–Ω–æ, —â–æ –¥–∏–≤–∏—Ç–∏—Å—å —è–∫ –ª—é–¥–∏–Ω–∞ –∑–º—É—à–µ–Ω–∞ –º–∏—Ä–∏—Ç–∏—Å—å –∑ —Ç–∞–∫–æ—é –ø—Ä–æ–±–ª–µ–º–æ—é —è –Ω–µ –º—ñ–≥. –ü—Ä–∏–≥–∞–¥–∞–≤—à–∏, —â–æ –∫–æ–ª–∏—Å—å –¥–∞–≤–Ω–æ —è –±–∞—á–∏–≤ –≤ KDE3 –Ω–∞ OpenSUSE 10 —Ñ—É–Ω–∫—Ü—ñ—é, —è–∫–∞ –¥–æ–∑–≤–æ–ª—è–ª–∞ —ñ–∑ –≥–æ–ª–æ–≤–Ω–æ–≥–æ –º–µ–Ω—é –ø–µ—Ä–µ–∑–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏—Å—å —É Windows, —è —Ç—Ä–æ—Ö–∏ –ø–æ–≤–∏–≤—á–∞–≤ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é –ø—Ä–æ `grub-reboot` —Ç–∞ –Ω–∞–ø–∏—Å–∞–≤ –Ω–∞—Å—Ç—É–ø–Ω–∏–π —Å–∫—Ä–∏–ø—Ç:

{{< highlight plaintext >}}
#!/usr/bin/env bash

readarray -t OPTIONS < <(awk -F"'" '$1=="menuentry " || $1=="submenu " {print i++ "\n\"" $2"\""};' /boot/grub/grub.cfg);

TERMINAL=$(tty);
CHOICE=$(dialog --clear --menu "Choose OS to boot at next startup:" 0 0 0 "${OPTIONS[@]}" 2>&1 >$TERMINAL) || exit 0;
sudo grub-reboot $CHOICE;
sudo reboot;
{{< /highlight >}}

–°–∫—Ä–∏–ø—Ç –¥–æ—Å–∏—Ç—å –ø—Ä–æ—Å—Ç–∏–π. –ó–∞ –¥–æ–ø–æ–º–æ–≥–æ—é `awk` –º–∏ –æ—Ç—Ä–∏–º—É—î–º–æ —Å–ø–∏—Å–æ–∫ –û–° –∑ —Ñ–∞–π–ª—É `/boot/grub/grub.cfg` —Ç–∞ –∑–∞–ø–∏—Å—É—î–º–æ  –π–æ–≥–æ –≤ –∑–º—ñ–Ω–Ω—É `OPTIONS`. –î–∞–ª—ñ –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é `dialog` –ø—Ä–æ–ø–æ–Ω—É—î–º–æ –æ–±—Ä–∞—Ç–∏ –û–° —ñ –≤ —Ä–∞–∑—ñ –≤—ñ–¥–º–æ–≤–∏ –≤–∏–∫–æ–Ω—É—î–º–æ –∫–æ–º–∞–Ω–¥—É `exit 0`. –Ø–∫—â–æ –∂ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á –æ–±—Ä–∞–≤ —â–æ—Å—å –∑—ñ —Å–ø–∏—Å–∫—É, —Ç–æ –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é `grub-reboot` –±—É–¥–µ —Å—Ç–≤–æ—Ä–µ–Ω–∏–π —Ç–∏–º—á–∞—Å–æ–≤–∏–π —Ñ–∞–π–ª, —è–∫–∏–π –±—É–¥–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–∏–π GRUB2 –¥–ª—è –æ–±—Ä–∞–Ω–Ω—è —ñ–Ω—à–æ–≥–æ –ø—É–Ω–∫—Ç—É –º–µ–Ω—é –ø—ñ—Å–ª—è –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è. –ö–æ–º–∞–Ω–¥–∞ `reboot` –∑–≤—ñ—Å–Ω–æ —â–æ –≤—ñ–¥–ø—Ä–∞–≤–∏—Ç—å –∫–æ–º–ø'—é—Ç–µ—Ä –ø–µ—Ä–µ–∑–∞–≤–∞–Ω—Ç–∞–∂—É–≤–∞—Ç–∏—Å—å. –ü—Ä–∏ –∑–∞–ø—É—Å–∫—É —ñ–∑ —Ç–µ—Ä–º—ñ–Ω–∞–ª–∞ –≤–∏–≥–ª—è–¥–∞—î —Ü–µ —è–∫–æ—Å—å —Ç–∞–∫:

![screenshot 1](/images/2021/grub-reboot-into-another-os/grub-reboot-menu.png#center "grub-reboot menu")

–ê–±–∏ –Ω–µ –∑–∞–ø—É—Å–∫–∞—Ç–∏ –∫–æ–∂–Ω–æ–≥–æ —Ä–∞–∑—É —Å–∫—Ä–∏–ø—Ç –≤—Ä—É—á–Ω—É —ñ–∑ —Ç–µ—Ä–º—ñ–Ω–∞–ª–∞, —è –≤–∏—Ä—ñ—à–∏–≤ —Å—Ç–≤–æ—Ä–∏—Ç–∏ –≤—ñ–¥–ø–æ–≤—ñ–¥–Ω–∏–π –∑–Ω–∞—á–æ–∫ –Ω–∞ —Ä–æ–±–æ—á–æ–º—É —Å—Ç–æ–ª—ñ.

**–£–≤–∞–≥–∞, —Ç—É—Ç —Ç–∞ –Ω–∞–¥–∞–ª—ñ `/home/user` –ø–æ—Ç—Ä—ñ–±–Ω–æ –±—É–¥–µ –∑–∞–º—ñ–Ω—é–≤–∞—Ç–∏ –Ω–∞ –¥–æ–º–∞—à–Ω—é –¥–∏—Ä–µ–∫—Ç–æ—Ä—ñ—é –≤–∞—à–æ–≥–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞.**

–©–æ–± –±—É–ª–æ –∑—Ä—É—á–Ω—ñ—à–µ, —è –ø–µ—Ä–µ–º—ñ—Å—Ç–∏–≤ —Å–∫—Ä–∏–ø—Ç –∑–∞ –Ω–∞—Å—Ç—É–ø–Ω–∏–º —à–ª—è—Ö–æ–º `/home/user/.local/bin/grub-once.sh` —Ç–∞ —Å–∫–æ—Ä–∏—Å—Ç–∞–≤—à–∏—Å—å –∫–æ–º–∞–Ω–¥–æ—é `sudo visudo` –¥–æ–¥–∞–≤ —É —Ñ–∞–π–ª `/etc/sudoers` –Ω–∞—Å—Ç—É–ø–Ω–∏–π —Ä—è–¥–æ–∫ –∞–±–∏ –º–æ–∂–Ω–∞ –±—É–ª–æ –∑–∞–ø—É—Å–∫–∞—Ç–∏ —Å–∫—Ä–∏–ø—Ç –±–µ–∑ –∑–∞–ø–∏—Ç—É –ø–∞—Ä–æ–ª—è:

{{< highlight plaintext >}}
user ALL=NOPASSWD:/home/user/.local/bin/grub-once.sh
{{< /highlight >}}

–î–∞–ª—ñ –Ω–∞ —Ä–æ–±–æ—á–æ–º—É —Å—Ç–æ–ª—ñ –±—É–≤ —Å—Ç–≤–æ—Ä–µ–Ω–∏–π —Ñ–∞–π–ª `grub-once.desktop` –∑ –Ω–∞—Å—Ç—É–ø–Ω–∏–º –∑–º—ñ—Å—Ç–æ–º:

{{< highlight plaintext >}}
[Desktop Entry]
Name=Grub reboot chooser
GenericName=Grub reboot chooser
Comment=Choose OS to boot at next startup
Exec=sudo /home/user/.local/bin/grub-once.sh
Terminal=true
Type=Application
Icon=/home/user/.local/share/icons/hicolor/256x256/grub-once.png
Categories=Utility;
StartupNotify=false
{{< /highlight >}}

–¢–µ–ø–µ—Ä –ø—Ä–æ—Å—Ç–æ —Ç–∏—Ü–Ω—É–≤—à–∏ –Ω–∞ –∑–Ω–∞—á–æ–∫ –Ω–∞ —Ä–æ–±–æ—á–æ–º—É —Å—Ç–æ–ª—ñ –±—É–¥–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –≤—ñ–¥–∫—Ä–∏–≤–∞—Ç–∏—Å—å –≤–∞—à —É–ª—é–±–ª–µ–Ω–∏–π —Ç–µ—Ä–º—ñ–Ω–∞–ª, –≤ —è–∫–æ–º—É –±—É–¥–µ –∑–∞–ø—É—â–µ–Ω–æ —Å–∫—Ä–∏–ø—Ç. –Ü–∫–æ–Ω–∫—É –¥–ª—è `desktop` —Ñ–∞–π–ª—É –≤–∂–µ —Å–∞–º—ñ –æ–±–µ—Ä–µ—Ç–µ —è–∫–∞ –≤–∞–º –ø–æ–¥–æ–±–∞—î—Ç—å—Å—è. üôÉ
